<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />

    <script type='text/javascript' src='http://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=AnOeSZ6a7LgcnBLVjmZ4xfQWIWZjzKv7bDwgyRk-W4NlkGnZGQdk5atUjsunU5yH' async defer></script>
    <script type='text/javascript' src='http://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=AnOeSZ6a7LgcnBLVjmZ4xfQWIWZjzKv7bDwgyRk-W4NlkGnZGQdk5atUjsunU5yH' async defer></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/pagina_motorista.css">
</head>
<body>
  <script type='text/javascript'>
        var map;
        var directionsManager;

        function GetMap()
        {
            map = new Microsoft.Maps.Map('#myMap', {});

            var enderec = '';

            function getText() {
              enderec = document.getElementById("endereco").value;
              return enderec;
            }

            function calc() {
            navigator.geolocation.getCurrentPosition(function (position) {
                        var loc = new Microsoft.Maps.Location(
                            position.coords.latitude,
                            position.coords.longitude);

                        Microsoft.Maps.loadModule('Microsoft.Maps.Directions', function () {
                            //Create an instance of the directions manager.
                            directionsManager = new Microsoft.Maps.Directions.DirectionsManager(map);

                            //Create waypoints to route between.
                            var seattleWaypoint = new Microsoft.Maps.Directions.Waypoint({location: loc});
                            directionsManager.addWaypoint(seattleWaypoint);

                            var workWaypoint = new Microsoft.Maps.Directions.Waypoint({address: getText()});
                            directionsManager.addWaypoint(workWaypoint);

                            //Add event handlers to directions manager.
                            Microsoft.Maps.Events.addHandler(directionsManager, 'directionsError', directionsError);
                            Microsoft.Maps.Events.addHandler(directionsManager, 'directionsUpdated', directionsUpdated);

                            //Calculate directions.
                            directionsManager.calculateDirections();
                        });
            });}


            document.getElementById("botao").addEventListener("click", calc);
            //Load the directions module.
        }

        function directionsUpdated(e) {
            //Get the current route index.
            var routeIdx = directionsManager.getRequestOptions().routeIndex;

            //Get the distance of the route, rounded to 2 decimal places.
            var distance = Math.round(e.routeSummary[routeIdx].distance * 100)/100;

            //Get the distance units used to calculate the route.
            var units = directionsManager.getRequestOptions().distanceUnit;
            var distanceUnits = '';

            if (units == Microsoft.Maps.Directions.DistanceUnit.km) {
                distanceUnits = 'km'
            } else {
                //Must be in miles
                distanceUnits = 'miles'
            }

            //Time is in seconds, convert to minutes and round off.
            var time = Math.round(e.routeSummary[routeIdx].timeWithTraffic / 60);

            //document.getElementById('routeInfoPanel').innerHTML = 'Distance: ' + distance + ' ' + distanceUnits + '<br/>Time with Traffic: ' + time + ' minutes';
        }

        function directionsError(e) {
            alert('Error: ' + e.message + '\r\nResponse Code: ' + e.responseCode)
        }
    </script>

  <div id="principal">
    <div id="menu">
      <input type="checkbox" id="check">
      <label class="icone" for="check"><i class="fa fa-bars" aria-hidden="true"></i></label>
      <div class="barra">
          <br><br><br><br><br><br>
          <div id="entrada">
            <label for="endereco"><p id="lEndereco">Destino: </p></label>
            <input name="endereco" required="required" id="endereco" type="text"> <br><br>
            <button type="button" id="botao" name="button"><p id="carcular">Calcular rota</p></button>
          </div>
          <h1 id="grex">&nbsp; &nbsp; <a href="index.html">grex</a></h1> &nbsp;&nbsp;&nbsp;&nbsp;
      </div>
    </div>
    <div id="myMap" style="position:fixed;width:auto;height:693px;"></div>
  </div>
  <div id='routeInfoPanel'></div>
</body>
</html>
